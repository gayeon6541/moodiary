<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>꽃 카드 상세</title>

    <!-- Fonts -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretendard@1.3.9/dist/web/static/pretendard.css"
        crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500&display=swap" rel="stylesheet">

    <style>
        :root {
            --ink: #111;
            --muted: #666;
            --bg: #fff;
            --header-h: 72px;
            --side: clamp(18px, 3.8vw, 48px);
            --chip: #fff;
            --chip-b: #111;

            /* today.html 사각 카드 변수 톤 */
            --border-w: 1px;
            --line: #111;
            --radius: 0;
            /* ← 사각 */
        }

        * {
            box-sizing: border-box
        }

        body {
            margin: 0;
            background: var(--bg);
            color: var(--ink);
            font-family: Pretendard, system-ui, -apple-system, BlinkMacSystemFont, Inter, sans-serif;
            line-height: 1.6;
        }

        /* ===== Header ===== */
        header.site {
            position: sticky;
            top: 0;
            z-index: 50;
            height: var(--header-h);
            background: rgba(255, 255, 255, .9);
            backdrop-filter: blur(6px);
            border-bottom: 1px solid #eaeaea;
        }

        .wrap {
            max-width: 100%;
            margin: 0 auto;
            padding: 0 var(--side);
        }

        .bar {
            height: var(--header-h);
            display: grid;
            gap: 10px;
            grid-template-columns: 140px 1fr auto auto;
            align-items: center;
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            color: inherit;
        }

        .brand img {
            width: 40px;
            height: 40px;
            display: block;
            animation: float 2.4s ease-in-out infinite;
        }

        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-5px);
            }
        }

        nav.main {
            display: flex;
            justify-content: flex-end;
            gap: 22px;
        }

        nav.main a {
            position: relative;
            text-decoration: none;
            color: var(--ink);
            padding: 4px 2px;
            font-weight: 500;
        }

        nav.main a::after {
            content: "";
            position: absolute;
            left: 0;
            right: 0;
            bottom: -6px;
            height: 2px;
            background: currentColor;
            transform: scaleX(0);
            transform-origin: 0 50%;
            transition: transform .25s;
        }

        /* hover시에만 밑줄 */
        nav.main a:hover::after {
            transform: scaleX(1);
        }

        .sound {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: var(--muted);
            margin-left: clamp(10px, 1.2vw, 18px);
            /* flower.html과 동일 */
        }

        .sound button {
            border: 1.25px solid #000;
            border-radius: 0;
            background: #fff;
            padding: 8px 12px;
            cursor: pointer;
            transition: background .25s ease, color .25s ease;
        }

        .sound button:hover {
            background: #000;
            color: #fff;
        }


        /* ===== Page ===== */
        main.page {
            max-width: 1040px;
            margin: 0 auto;
            padding: 24px var(--side) 64px;
        }

        .crumbs {
            display: flex;
            gap: 8px;
            align-items: center;
            font-size: 13px;
            color: #777;
            margin: 110px 0 16px;
        }

        .crumbs a {
            color: inherit;
            text-decoration: none;
        }

        .crumbs .sep {
            opacity: .5
        }

        .hero {
            display: grid;
            grid-template-columns: minmax(260px, 380px) 1fr;
            gap: 28px;
            align-items: center;
        }

        /* ——— 카드 테두리/박스 제거 ——— */
        .hero-card {
            border: none !important;
            background: transparent !important;
            box-shadow: none !important;
            overflow: visible;
            /* 여백이 자연스럽게 */
        }

        /* 카드 내부도 배경 없이 깔끔하게 */
        .hero-img {
            background: transparent !important;
            aspect-ratio: 1 / 1;
            /* 1:1로 통일해 심미성 ↑ */
            display: grid;
            place-items: center;
        }

        /* SVG가 영역에 딱 맞게 보이도록 */
        .hero-img img {
            max-width: 100%;
            max-height: 100%;
            width: min(560px, 42vw);
            /* 큰 화면에서 시원하게 */
            height: auto;
            object-fit: contain;
            display: block;
        }



        /* ===== 텍스트/칩/메타 (사각 요소 일관성) ===== */
        .title {
            font-family: 'Playfair Display', serif;
            font-size: 34px;
            letter-spacing: .3px;
            margin: 0 0 6px;
            color: #222;
        }

        .subtitle {
            margin: 0 0 14px;
            color: #666;
            font-size: 15px;
        }

        .chips {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 14px 0 10px;
        }

        .chip {
            border: var(--border-w) solid var(--line);
            background: #fff;
            padding: 8px 10px;
            border-radius: var(--radius);
            font-size: 13px;
        }

        .desc {
            margin-top: 10px;
            color: #333;
            font-size: 16px;
            line-height: 1.75;
        }

        .meta {
            margin-top: 22px;
            display: grid;
            grid-template-columns: repeat(2, minmax(200px, 1fr));
            gap: 14px;
        }

        .meta dt {
            font-weight: 700
        }

        .meta dd {
            margin: 0;
            color: #444
        }

        .nav-rows {
            margin-top: 28px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            border: var(--border-w) solid var(--line);
            background: #fff;
            padding: 10px 14px;
            cursor: pointer;
            text-decoration: none;
            color: #111;
            transition: background .2s, color .2s, transform .1s;
            border-radius: var(--radius);
        }

        .btn:hover {
            background: #000;
            color: #fff;
        }

        .btn:active {
            transform: translateY(1px);
        }

        /* 소형 화면 */
        @media(max-width:900px) {
            .hero {
                grid-template-columns: 1fr;
                gap: 16px;
            }
        }

        /* === Custom Flower Cursor (same as index.html) === */
        body {
            cursor: none;
        }

        .flower-cursor {
            position: fixed;
            left: 0;
            top: 0;
            z-index: 9999;
            pointer-events: none;
            user-select: none;
            width: 40px;
            height: 40px;
            display: grid;
            place-items: center;
            font-size: 24px;
            line-height: 1;
            transform: translate(-50%, -50%);
            filter: drop-shadow(0 2px 2px rgba(0, 0, 0, .12));
        }

        .flower-cursor::before {
            content: "";
            position: absolute;
            inset: 0;
            border: 2px solid #111;
            border-radius: 999px;
            box-sizing: border-box;
        }

        .flower-cursor.active {
            font-size: 26px;
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="site">
        <div class="wrap">
            <div class="bar">
                <a class="brand" href="index.html" aria-label="MOODIARY Home">
                    <img src="img/sub-flower.svg" alt="MOODIARY 로고"><span>MOODIARY</span>
                </a>
                <div></div>
                <nav class="main" aria-label="Main">
                    <a href="today-loding.html">Today</a>
                    <a href="diary-loding.html">Diary</a>
                    <a href="flower-loding.html" class="active">Flower</a>
                </nav>
                <div class="sound">
                    <button id="soundToggle" aria-pressed="false">🔊 Sound (On)</button>
                    <audio id="bgm" preload="auto" autoplay loop playsinline src="audio/temp.m4a"></audio>
                </div>
            </div>
        </div>
    </header>

    <main class="page" aria-label="Flower Detail">
        <nav class="crumbs" aria-label="breadcrumbs">
            <a href="flower.html">Flower</a><span class="sep">›</span><span id="crumbLabel">Detail</span>
        </nav>

        <section class="hero">
            <!-- today.html 톤의 사각 카드 (캡션 제거됨) -->
            <div class="hero-card">
                <div class="hero-img"><img id="f-img" alt=""></div>
            </div>

            <div>
                <h1 class="title" id="f-title">FLOWER</h1>
                <p class="subtitle" id="f-sub">—</p>

                <div class="chips" id="f-chips"></div>
                <div class="desc" id="f-desc"></div>

                <dl class="meta">
                    <div>
                        <dt>영문명</dt>
                        <dd id="f-en">—</dd>
                    </div>
                    <div>
                        <dt>국문명</dt>
                        <dd id="f-ko">—</dd>
                    </div>
                    <div>
                        <dt>상징</dt>
                        <dd id="f-sym">—</dd>
                    </div>
                    <div>
                        <dt>연결 감정</dt>
                        <dd id="f-emote">—</dd>
                    </div>
                </dl>

                <div class="nav-rows">
                    <a class="btn" href="flower.html">← 목록으로</a>
                    <a class="btn" id="f-prev" href="#">〈 이전</a>
                    <a class="btn" id="f-next" href="#">다음 〉</a>
                </div>
            </div>
        </section>
    </main>

    <script>
        /* MOODIARY — Global BGM (m4a, 이어듣기/음소거 상태 유지) */
        (function () {
            const audio = document.getElementById('bgm');
            const btn = document.getElementById('soundToggle');

            if (!audio || !btn) return;

            // ✅ 모든 페이지에서 같은 키를 씁니다 (이미 쓰던 키와 호환)
            const STATE_KEY = 'moodiary_bgm_state'; // 'on' | 'off'
            const POS_KEY = 'moodiary_bgm_pos';   // 재생 위치(초)
            const VOL_KEY = 'moodiary_bgm_vol';   // 0.0 ~ 1.0

            // ✅ 파일 강제 통일
            const DESIRED_SRC = 'audio/temp.m4a';
            if (audio.getAttribute('src') !== DESIRED_SRC) audio.setAttribute('src', DESIRED_SRC);

            // 버튼 라벨 동기화
            function setBtn(on) {
                btn.textContent = on ? '🔊 Sound (On)' : '🔈 Sound (Off)';
                btn.setAttribute('aria-pressed', on ? 'true' : 'false');
            }

            // 부드러운 볼륨 페이드
            const fps = 60;
            function fadeTo(target = 0.35, ms = 800) {
                target = Math.max(0, Math.min(1, target));
                const step = (target - audio.volume) / (ms / (1000 / fps));
                const t = setInterval(() => {
                    audio.volume = Math.max(0, Math.min(1, audio.volume + step));
                    if ((step > 0 && audio.volume >= target) || (step < 0 && audio.volume <= target)) {
                        clearInterval(t);
                        localStorage.setItem(VOL_KEY, String(audio.volume));
                    }
                }, 1000 / fps);
            }

            async function tryPlay() {
                try {
                    audio.muted = false;
                    audio.volume = parseFloat(localStorage.getItem(VOL_KEY) || '0.30');
                    await audio.play();
                    setBtn(true);
                    fadeTo(parseFloat(localStorage.getItem(VOL_KEY) || '0.35'), 700);
                } catch (e) {
                    // 첫 사용자 제스처 전 자동재생이 막힌 경우: 한 번만 탭 이벤트로 언락
                    setBtn(false);
                    const unlock = async () => {
                        try {
                            await audio.play();
                            setBtn(true);
                            fadeTo(parseFloat(localStorage.getItem(VOL_KEY) || '0.35'), 700);
                        } catch { }
                        finally {
                            window.removeEventListener('pointerdown', unlock, { once: true });
                        }
                    };
                    window.addEventListener('pointerdown', unlock, { once: true });
                }
            }

            // ▶ 새 페이지에서 재생 위치 복원(이어듣기 핵심)
            audio.addEventListener('loadedmetadata', () => {
                const pos = parseFloat(localStorage.getItem(POS_KEY) || '0');
                if (isFinite(pos) && pos > 0 && (!isFinite(audio.duration) || pos < audio.duration - 0.4)) {
                    audio.currentTime = pos;
                }
            });

            // ▶ 0.7초마다, 그리고 페이지 떠날 때 현재 위치 저장
            const savePos = () => {
                if (isFinite(audio.currentTime)) localStorage.setItem(POS_KEY, String(audio.currentTime));
            };
            const posTimer = setInterval(savePos, 700);
            window.addEventListener('pagehide', savePos);

            // ▶ 버튼 토글: 상태를 localStorage에 저장 → 다음 페이지에도 그대로 반영
            btn.addEventListener('click', async () => {
                if (audio.paused) {
                    localStorage.setItem(STATE_KEY, 'on');
                    await tryPlay();
                } else {
                    audio.pause();
                    setBtn(false);
                    localStorage.setItem(STATE_KEY, 'off');
                }
            });

            // ▶ 첫 진입 시 상태/위치 반영
            if ((localStorage.getItem(STATE_KEY) ?? 'on') === 'on') {
                tryPlay();
            } else {
                setBtn(false);
            }

            // ▶ 탭을 다시 볼 때, 켜두었는데 멈춰 있으면 즉시 재개
            document.addEventListener('visibilitychange', () => {
                if (!document.hidden && localStorage.getItem(STATE_KEY) === 'on' && audio.paused) {
                    tryPlay();
                }
            });
        })();
    </script>


    <!-- ===== Detail Loader (캡션 제거 반영) ===== -->
    <script>
        const FLOWERS = [
            {
                slug: 'hydrangea', en: 'HYDRANGEA', ko: '수국', emotions: '감사 · 진심 · 변화', symbolism: '감사, 진심, 변덕', img: 'img/flowers2/hydrangea2.svg',
                desc: '작은 꽃송이들이 모여 둥글게 피는 수국은 ‘감사’와 ‘진심’을 상징해요. 기쁨이 쌓여 더 큰 행복이 되고, 주변과 나누며 깊어지는 감정을 표현합니다.'
            },

            {
                slug: 'babybreath', en: "BABY'S BREATH", ko: '안개꽃', emotions: '순수 · 응원 · 위로', symbolism: '순수, 영원, 배려', img: 'img/flowers2/babybreath2.svg',
                desc: '가는 줄기 위에 촘촘히 피어난 안개꽃은 ‘순수한 사랑’과 ‘변치 않는 마음’을 상징해요. 설렘의 순간이 잔잔한 기대감으로 이어지도록 도와줍니다.'
            },

            {
                slug: 'lavender', en: 'LAVENDER', ko: '라벤더', emotions: '휴식 · 안정 · 집중', symbolism: '평온, 헌신', img: 'img/flowers2/lavender2.svg',
                desc: '라벤더는 은은한 향기와 보랏빛으로 ‘평온’과 ‘정서적 안정’을 의미해요. 마음의 긴장을 풀어주고 차분한 상태를 유지하게 해줍니다.'
            },

            {
                slug: 'freesia', en: 'FREESIA', ko: '프리지아', emotions: '설렘 · 시작 · 고마움', symbolism: '순수, 신뢰', img: 'img/flowers2/freesia2.svg',
                desc: '부드럽고 따뜻한 색감의 프리지아는 ‘위로’와 ‘새 출발’을 상징해요. 상실감과 슬픔 속에서도 다시 걸어 나갈 수 있는 희망을 전해줍니다.'
            },

            {
                slug: 'daisy', en: 'DAISY', ko: '데이지', emotions: '기쁨 · 솔직함 · 맑음', symbolism: '순진무구, 희망', img: 'img/flowers2/daisy2.svg',
                desc: '데이지는 단순하고 밝은 형태로 ‘순수한 우정’과 ‘희망’을 뜻해요. 외로운 마음을 포근하게 감싸주며, 사람과 다시 연결될 수 있는 가능성을 느끼게 해줍니다.'
            },

            {
                slug: 'white-lily', en: 'WHITE LILY', ko: '흰 백합', emotions: '존중 · 숭고함 · 위엄', symbolism: '순결, 고결', img: 'img/flowers2/white-lily2.svg',
                desc: '흰 백합은 ‘순수함’과 ‘정화’를 상징해요. 격해진 감정을 조용히 가라앉히고, 내면의 균형을 되찾을 수 있도록 도와줍니다.'
            },

            {
                slug: 'lilac', en: 'LILAC', ko: '라일락', emotions: '그리움 · 봄기운 · 포근함', symbolism: '우정, 추억', img: 'img/flowers2/lilac2.svg',
                desc: '라일락은 ‘휴식’과 ‘영혼의 안정’을 의미하며, 향기와 색이 지친 몸과 마음을 편안하게 감싸줍니다. 회복과 쉼을 상징하는 꽃이에요.'
            },

            {
                slug: 'white-tulip', en: 'WHITE TULIP', ko: '흰 튤립', emotions: '응원 · 담백함 · 다짐', symbolism: '순수, 용서', img: 'img/flowers2/white-tulip2.svg',
                desc: '하얀 튤립은 ‘용기’, ‘새로운 시작’을 상징해요. 불안한 감정 속에서도 부드럽게 위로해주며, 앞으로 나아갈 수 있는 힘을 북돋아줍니다.'
            },

            {
                slug: 'sunflower', en: 'SUNFLOWER', ko: '해바라기', emotions: '행복 · 충실 · 에너지', symbolism: '동경, 충성', img: 'img/flowers2/sunflower2.svg',
                desc: '태양을 향해 피어나는 해바라기는 ‘긍정’, ‘존경’, ‘감사’를 의미해요. 밝고 활기찬 감정에 에너지를 더하고, 감사한 마음을 전하는 데 적합합니다.'
            },

            {
                slug: 'peony', en: 'PEONY', ko: '작약', emotions: '풍요 · 축복 · 따뜻함', symbolism: '부, 번영', img: 'img/flowers2/peony2.svg',
                desc: '풍성하고 화려한 작약은 ‘행복한 삶’과 ‘깊은 애정’을 상징해요. 과거의 후회를 따뜻하게 감싸며, 스스로를 받아들이고 성장할 수 있는 용기를 줍니다.'
            },

            {
                slug: 'forgetmenot', en: 'FORGET-ME-NOT', ko: '물망초', emotions: '기억 · 연결 · 소중함', symbolism: '진실한 사랑, 추억', img: 'img/flowers2/forgetmenot2.svg',
                desc: '작고 파란 물망초는 ‘진실한 사랑’과 ‘기억’을 뜻해요. 떠난 것에 대한 아픔을 인정하고, 소중한 기억으로 간직할 수 있게 도와줍니다.'
            },

            {
                slug: 'lotus', en: 'LOTUS', ko: '연꽃', emotions: '회복 · 성찰 · 평온', symbolism: '청정, 재생', img: 'img/flowers2/lotus2.svg',
                desc: '진흙 속에서도 맑고 깨끗하게 피는 연꽃은 ‘청정’, ‘극복’, ‘내면의 평화’를 상징해요. 복잡하고 흔들리는 마음을 정리하고 중심을 잡게 해줍니다.'
            }
        ];

        const order = FLOWERS.map(f => f.slug);

        function qs(key) { const p = new URLSearchParams(location.search); return p.get(key) || ''; }
        function getData(slug) { return FLOWERS.find(f => f.slug === slug) || FLOWERS[0]; }

        function render(d) {
            const img = document.getElementById('f-img');
            img.src = d.img; img.alt = d.en;

            // 상단 타이틀/부제, 정보 패널
            document.getElementById('f-title').textContent = d.en;
            document.getElementById('f-sub').textContent = d.ko;

            const chips = document.getElementById('f-chips');
            chips.innerHTML = '';
            d.emotions.split('·').map(s => s.trim()).forEach(t => {
                const c = document.createElement('span'); c.className = 'chip'; c.textContent = t; chips.appendChild(c);
            });

            document.getElementById('f-desc').textContent = d.desc;
            document.getElementById('f-en').textContent = d.en;
            document.getElementById('f-ko').textContent = d.ko;
            document.getElementById('f-sym').textContent = d.symbolism;
            document.getElementById('f-emote').textContent = d.emotions;

            document.getElementById('crumbLabel').textContent = d.en;

            const idx = order.indexOf(d.slug);
            const prev = order[(idx - 1 + order.length) % order.length];
            const next = order[(idx + 1) % order.length];
            document.getElementById('f-prev').href = `flower-detail.html?flower=${encodeURIComponent(prev)}`;
            document.getElementById('f-next').href = `flower-detail.html?flower=${encodeURIComponent(next)}`;

            document.title = `꽃 카드 상세 - ${d.en}`;
        }

        (function () {
            const slug = qs('flower');
            const data = getData(slug);
            render(data);
        })();
    </script>

    <script>
        // ✿ Custom Flower Cursor (same as index.html)
        (function () {
            const c = document.createElement('div');
            c.className = 'flower-cursor';
            c.textContent = '✿';
            document.body.appendChild(c);

            let x = 0, y = 0, tx = 0, ty = 0;
            document.addEventListener('mousemove', e => { x = e.clientX; y = e.clientY; });

            // 링크/버튼 위에 올리면 살짝 커지는 효과
            document.addEventListener('mouseover', e => {
                if (e.target.closest('a,button')) c.classList.add('active');
                else c.classList.remove('active');
            });

            // 부드러운 추적
            (function loop() {
                tx += (x - tx) * 0.25;
                ty += (y - ty) * 0.25;
                c.style.transform = `translate(${tx}px, ${ty}px) translate(-50%,-50%)`;
                requestAnimationFrame(loop);
            })();
        })();
    </script>
    <script>
        /* SPA: 이전/다음 클릭 시 페이지 리로드 없이 내용만 갱신 */
        (function SPAFlowerDetail() {
            const prevEl = document.getElementById('f-prev');
            const nextEl = document.getElementById('f-next');
            const titleEl = document.getElementById('f-title');

            // 현재 slug로 화면 갱신 + URL 동기화
            function go(slug, { push = true } = {}) {
                const data = getData(slug);
                render(data);

                // 주소 표시줄만 업데이트 (페이지 리로드 없음)
                if (push) history.pushState({ slug }, '', `?flower=${encodeURIComponent(slug)}`);

                // 접근성/UX: 제목에 포커스 줘서 스크롤 튐 없이 컨텍스트 알리기
                titleEl.setAttribute('tabindex', '-1');
                titleEl.focus({ preventScroll: true });
            }

            // 공통 클릭 핸들러
            function onClickNav(e) {
                e.preventDefault();
                const url = new URL(e.currentTarget.href, location.href);
                const slug = url.searchParams.get('flower') || order[0];
                go(slug, { push: true });
            }

            // 이전/다음 버튼에 SPA 내비게이션 연결
            prevEl.addEventListener('click', onClickNav);
            nextEl.addEventListener('click', onClickNav);

            // 브라우저 뒤로가기/앞으로가기 대응
            window.addEventListener('popstate', (e) => {
                const slug = (e.state && e.state.slug) || (new URLSearchParams(location.search).get('flower')) || order[0];
                go(slug, { push: false });
            });

            // 초기 상태를 history에 기록 (중복 렌더 방지: render는 기존 코드에서 한 번 실행됨)
            const initial = (new URLSearchParams(location.search).get('flower')) || order[0];
            history.replaceState({ slug: initial }, '', location.href);
        })();
    </script>

</body>

</html>